<body ng-app="app" ng-controller="OrgController as ctrl">
<%= render "shared/navbar", input_name: "ctrl.searchInput" %>
<div class="container-fluid">
  <div class="row">
    <div class="col-sm-3 col-md-2 sidebar" style="padding-top:0px">
      <ul class="nav nav-sidebar">
        <li>
          <div style="font-weight: bold; font-size: 12pt; padding-top:5px; padding-bottom:10px; padding-left:20px; background-color: lightgrey">
            Organizations
            <button type="button" data-ng-click="ctrl.showOrgModal()" class="btn btn-sm btn-primary pull-right" style="margin-right: 5px;line-height: 1.2">Add</button>
          </div>
        </li>
        <li ng-repeat="org in ctrl.orgs | filter:ctrl.searchInput" ng-class="{'active':$index == ctrl.selectedOrg}"
            ng-click="ctrl.setClickedOrg($index, org.full_name, org.id)">
          <a href="#">{{org.name}}</a>

        </li>
      </ul>
    </div>
    <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
      <%= render "shared/alert_msg" %>
      <h2 class="sub-header">Student Work History
        <button class="btn-file btn btn-primary" name="export" ng-if="ctrl.selectedOrg != -1">Export</button>
      </h2>
      <div class="jumbotron" ng-if="ctrl.selectedOrg == -1" style="background-color: transparent; text-align: center; padding-top:24px;">
        <h2>Select an Organization</h2>
        <p class="lead">To see an organization's student work history and organization details, select an organization
          from the list on the left.  The work history will appear at the top of the page, and the organizational
          details below.  To edit student work history, use the students view by either clicking on a students name or
          selecting Students from the top menu.
        </p>
      </div>
      <div class="table-responsive" ng-style="ctrl.truncateStyle" ng-if="ctrl.selectedOrg != -1">
        <table class="table table-striped">
          <thead>
          <tr>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Student Name</th>
            <th>Paid/Unpaid</th>
            <th>Work Day</th>
            <th>Student Class</th>
            <th style="text-align: center;">Grades</th>
            <th>Edit</th>
            <th>Delete</th>
          </tr>
          </thead>
          <tbody>
          <tr ng-repeat="student_assignment in ctrl.studentAssignments | filter:ctrl.searchInput"

              ng-class="{'selected':$index == ctrl.selectedRow}"

              ng-click="ctrl.showOrganizationDetails($index, student_assignment.id)" id="{{student_assignment.id}}">
            <td>{{ student_assignment.start_date }}</td>
            <td>{{ student_assignment.end_date }}</td>
            <td>{{ student_assignment.student_name }}</td>
            <td>{{ student_assignment.paid }}</td>
            <td>{{ student_assignment.work_day }}</td>
            <td>{{ student_assignment.student_gradelevel }}</td>
            <td style="text-align: center;">
              <button type="button" data-ng-click="ctrl.showGradesModal()" class="btn btn-sm btn-primary" style="background-color: #eee; line-height: 1.2">
                <%= image_tag("ellipsis.png", :alt => "Show Grades") %>
              </button>
            </td>
            <td><a href="/work_assignments/{{student_assignment.id}}/edit" target="_self"
                   ng-class="{'white-link': ctrl.selectedRow != null}">Edit</a></td>
            <td ng-click="$event.stopPropagation();"><img ng-src="<%=image_path("trash.png")%>" width="18" height="18"
                     ng-really-message="Are you sure you want to delete this assignment?"
                     ng-really-click="ctrl.deleteAssignment($index, student_assignment.id);" class="delete_object"></td>
          </tr>
          </tbody>
        </table>
      </div>
      <div class="table-responsive" style="padding-top:30px" ng-if="ctrl.selectedRow != null">
        <table class="table" style="margin-left: auto; margin-right: auto;">
          <tbody ng-repeat="org_detail in ctrl.orgDetails">
          <tr>
            <td style="font-weight: bold">Contact Name:</td>
            <td>{{ org_detail.contact_name }}</td>
            <td style="font-weight: bold">Email:</td>
            <td>{{ org_detail.email }}</td>
          </tr>
          <tr>
            <td style="font-weight: bold">Contact Title:</td>
            <td>{{ org_detail.title }}</td>
            <td style="font-weight: bold">Mobile Phone:</td>
            <td>{{ org_detail.mobile }}</td>
          </tr>
          <tr>
            <td style="font-weight: bold">Department:</td>
            <td>{{ org_detail.contact_department }}</td>
            <td style="font-weight: bold">Office Phone:</td>
            <td>{{ org_detail.office_phone }}</td>
          </tr>
          <tr>
            <td style="font-weight: bold">Address:</td>
            <td>{{ org_detail.contact_address }}</td>
            <td style="font-weight: bold">Fax:</td>
            <td>{{ org_detail.fax }}</td>
          </tr>
          <tr>
            <td style="font-weight: bold">&nbsp;</td>
            <td>{{ org_detail.contact_address }}</td>
            <td style="font-weight: bold">Earliest Start:</td>
            <td>{{ org_detail.earliest_start }}</td>
          </tr>
          <tr>
            <td style="font-weight: bold">Contact Start Date:</td>
            <td>{{ org_detail.contact_start_date }}</td>
            <td style="font-weight: bold">Latest Start:</td>
            <td>{{ org_detail.latest_start }}</td>
          </tr>
          <tr>
            <td style="font-weight: bold">Sponsor Since:</td>
            <td>{{ org_detail.contact_sponsor_since }}</td>
            <td style="font-weight: bold">Ideal Start:</td>
            <td>{{ org_detail.ideal_start }}</td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

</body>